<!DOCTYPE html>

<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
<!--[if IE]><meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'><![endif]-->
<meta name="viewport" content="width=device-width,initial-scale=1">

<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>System Identification and Laplace Transform | Cathy @ UIUC</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="System Identification and Laplace Transform" />
<meta property="og:locale" content="en" />
<meta name="description" content="“System identification using step response, impulse response and sine sweep”" />
<meta property="og:description" content="“System identification using step response, impulse response and sine sweep”" />
<link rel="canonical" href="http://localhost:4000/blog/2020/11/12/System-Identification/" />
<meta property="og:url" content="http://localhost:4000/blog/2020/11/12/System-Identification/" />
<meta property="og:site_name" content="Cathy @ UIUC" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-11-12T00:00:00-06:00" />
<script type="application/ld+json">
{"dateModified":"2020-11-12T00:00:00-06:00","url":"http://localhost:4000/blog/2020/11/12/System-Identification/","datePublished":"2020-11-12T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/2020/11/12/System-Identification/"},"description":"“System identification using step response, impulse response and sine sweep”","@type":"BlogPosting","headline":"System Identification and Laplace Transform","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<meta name="keywords" content="SystemIdentification" />





<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Cathy @ UIUC" />
    <link href='/assets/stylesheets/blog.css' rel="stylesheet" type="text/css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
<script>window.Modernizr || document.write('<script src="/assets/javascripts/modernizr-2.8.3.min.js"><\/script>')</script>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>
    window.jQuery || document.write('<script src="/assets/javascripts/jquery-3.3.1.min.js"><\/script>')
</script>

<script src="//cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
<script>
    window.Pace || document.write('<script src="/assets/javascripts/pace.min.js"><\/script>')
</script>

    
</head>

<body>
    

    <!--[if IE]>
    <p class="site-notice">You are using an outdated browser. Please <a href="http://browsehappy.com/" target="_blank">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true" target="_blank">activate Google Chrome Frame</a> to improve your experience.</p>
<![endif]-->
<noscript>
    <p class="site-notice">This site requires JavaScript. Here are the instructions <a href="http://www.enable-javascript.com/" target="_blank">how to enable JavaScript in your web browser</a>.</p>
</noscript>

    <div class="nav-wrapper overlay-wrapper">
    <div class="nav-form overlay-form">
        <span class="overlay-header menu">Menu</span>
        <a class="btn-close">Close</a>
        <div class="results">
            <ul>
                <li><a href="/blog/categories/">Categories</a></li>
                <li><a href="/blog/tags/">Tags</a></li>
                <li><a href="">About</a></li>
            </ul>
        </div>
    </div>
</div>

<div class="search-wrapper overlay-wrapper">
    <div class="search-form overlay-form">
        <input type="text" class="overlay-header search-field" placeholder="Search...">
        <a class="btn-close">Close</a>
        <ul class="results"></ul>
    </div>
</div>


    <div id="page" class="hentry">
        <header class="the-header">
    <div class="unit-head">
        <div class="unit-inner unit-head-inner">
            <nav class="nav-global">
                <ul>
                    <li class="logo nav-link">
                        <button class="btn-menu" title="Menu"></button>
                        <a href="/blog/">Cathy @ UIUC</a>
                        <!--[if !IE]> -->
                        <button class="btn-search" title="Search"></button>
                        <!-- <![endif]-->
                    </li>
                    <li class="nav-link"><a title="Categories" href="/blog/categories/">Categories</a></li>
                    <li class="nav-link"><a title="Tags" href="/blog/tags/">Tags</a></li>
                    <!--[if !IE]> -->
                    <li class="nav-link"><a title="Search" class="btn-search" href="#">Search</a></li>
                    <!-- <![endif]-->
                </ul>
            </nav>
        </div>
    </div>
</header>


        <div class="body animated fadeInDown" role="main">
            <div class="unit-body">
                <div class="unit-inner unit-body-inner">
                    <div class="entry-content">
                        <article class="unit-article layout-post">
    <div class="unit-inner unit-article-inner">
        <div itemscope itemtype="http://schema.org/Article" class="content">
            <header>
                <div class="unit-head">
                    <div class="unit-inner unit-head-inner">
                        <h1 class="entry-title" itemprop="name">System Identification and Laplace Transform</h1>
                    </div>
                </div>
            </header>
            <div class="bd article-content">
                <div class="entry-content">
                    <div class="meta">
                        <p class="date-publish">
                            Published:
                            <time itemprop="datePublished" class="date-pub updated"
                                title="2020-11-12T00:00:00-06:00" datetime="2020-11-12T00:00:00-06:00">November 12, 2020 </time>
                            by
                            <a class="author" href="/" rel="author" title="Show Author">
                                <span itemprop="author" itemscope itemtype="http://schema.org/Person">
                                    <span itemprop="name"></span>
                                </span>
                            </a>
                            
                                <a class="license-icon" rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" title="Show License">
                                    <img alt="Creative Commons Licence" style="border-width:0" src="/assets/images/theme/cc-by-sa.png"  height="16" width="80"/>
                                </a>
                            
                            
                        </p>
                        <ul class="list-category list-linear">
                            <li class="list-head">Categories: </li>
                             
     
        <li>
            <a href="/blog/categories/#control" title="control">
            control <span>1</span></a>
        </li>
    



                        </ul>
                        <ul class="list-tag list-linear">
                            <li class="list-head">Tags: </li>
                             
    
        
        <li>
            <a href="/blog/tags/#SystemIdentification" title="SystemIdentification">SystemIdentification <span>1</span></a>
        </li>
    




                        </ul>
                    </div>
                    <div itemprop="articleBody">
                        <script type="text/javascript" async="" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<p>Being a TA this semester gives me more joy than I ever expected. I was worried about teaching online (COVID19). Without face to face interaction, it is hard to tell if the students understand or not. However, I got the students' feedback all the time, and I enjoyed the class. I would spend days preparing slides that I was not obligated to do. From reviewing materials and gathering different perspectives and interpretations of the concept, I wanted to fill in the gap between hands-on work in the lab and the lectures' theory. Putting knowledge into words with toy examples and graphs was not easy. I finally understood why some people said we learn more when we teach. Other than that, the joy of getting students' improvements and positive feedback is enormous.</p>

<p>System identification is one of the topics I taught, and here is my note for the lecture. When I was an undergrad, I was not familiar with the term “system identification.” It shows up here and there, sometimes with a step function, sometimes with an impulse function, and sometimes with a sine sweep. This post put these three methods together with analysis using Laplace transform.</p>

<hr />

<h1 id="heading-first-order-system">First-Order System</h1>
<p>The first-order linear system is one of the most practical models. The input-output relationship can be described with a first-order differential equation. Furthermore, there are only two critical factors for this kind of system– DC gain and time constant. Once we find these two values, we know how the system behaves. Even with a higher-order system, sometimes we can observe a dominant first-order mode. Then, we can ignore those terms and consider the system as a first-order system.</p>

<p>A first-order time-invariant system has a characterization equation in the following form</p>

<script type="math/tex; mode=display">\tau \frac{dh(t)}{dt}+h(t)=k\,f(t)</script>

<p>where h is the system response to the force <script type="math/tex">f(t)</script>. The gain and the time constant are <script type="math/tex">k</script> and <script type="math/tex">\tau</script>.</p>

<p>We can get the solution for this equation using Laplace transform. Based on the input force function, we can observe the features of the corresponding analytical solution. Therefore, if there is a new system, we can inversely figure out the factors <script type="math/tex">k</script> and <script type="math/tex">\tau</script> by checking the output. The Laplace transform of the system is</p>

<script type="math/tex; mode=display">\tau s H(s) +H(s)=kF(s)</script>

<p>Here the only conversion I use from the Laplace table is
<script type="math/tex">f^{(N)}(t) \Leftrightarrow s^nF(s)</script>.</p>

<p>The system transfer function</p>

<script type="math/tex; mode=display">G(s)=H(s)/F(s)=\frac{k}{1+\tau s}</script>

<h1 id="heading-step-response">Step Response</h1>
<p>A step function is</p>

<script type="math/tex; mode=display">% <![CDATA[
u(t) =
    \begin{cases}
      1 & \text{if $t\geq0$}\\
      0 & \text{otherwise}
    \end{cases} %]]></script>

<p>And its Laplace transform can be found in a table
<script type="math/tex">U(s)=\frac{1}{s}</script></p>

<p>&lt;img src=“stepSys.jpeg" alt=“step input to an unknown system” width="200"/&gt;</p>

<p>Inputting a step function to the unknown first-order system will give us an output <script type="math/tex">Y(s)</script></p>

<script type="math/tex; mode=display">Y(s)=U(s)G(s)=\frac{1}{s}\frac{k}{1+\tau s}=\frac{k}{s+\frac{1}{\tau}}+\frac{k}{s}</script>

<p>The last step is obtained from doing <a href="[Partial-Fraction Decomposition: General Techniques](https://www.purplemath.com/modules/partfrac.htm)">Partial-Fraction Decomposition</a>. Rearranging the equation this way makes it easier to do the inverse Laplace transform back to time domain.</p>

<script type="math/tex; mode=display">y(t)=-ke^{-\frac{t}{\tau}+ku(t)</script>

<p>&lt;img src=“stepOut.jpeg" alt=“Output of a step input to an unknown system” width="200"/&gt;</p>

<p>Plotting out the function, we can see this equation is quite simple. There are two phases– transient and steady-state of the response. Amazingly, they correspond to the equation well. The first term has an exponential to the power of a negative sign multiply by the time. As time increases, this term is going to decay exponentially. Since the term's effect will be close to zero or negligible, we say it is transient. The second term, on the other hand, is just the input multiply by the gain. The only time factor is inside the input function. Therefore, it is called a steady-state response. Together, we can conclude the system's response is simply a scale of the input, with the gain <script type="math/tex">k</script>, while the transient to that response depends on the time constant <script type="math/tex">\tau</script>.</p>

<p>If we do not know about the system, we can give a step function and observe the output graph. The gain <script type="math/tex">k</script> is the scale factor between the original step function and the steady-state amplitude. To get the time constant <script type="math/tex">\tau</script> is tricker. Note that we can plug in <script type="math/tex">t=\tau</script> for the amplitude. This gives us</p>

<script type="math/tex; mode=display">y(\tau)=-ke^{\frac{\tau}{\tau}}+ku(\tau)=k(1-e^{-1})=0.6321k</script>

<p>Therefore, we can find the time that gives us 63% of the steady-state amplitude for our <script type="math/tex">\tau</script>. It is called the 63% rule.
Once the time constant and the gain are found from the plot, we are successfully identify the unknown system.</p>

<h1 id="heading-impulse-response">Impulse Response</h1>
<p>An impulse function <script type="math/tex">\delta(t)</script> has a non-zero value at only one instant. We can approximate this in real life with a hammer strike.
Its Laplace transform can be found in a table
<script type="math/tex">D(s)=1</script></p>

<p>&lt;img src=“impSys.jpeg" alt=“impulse input to an unknown system” width="200"/&gt;</p>

<p>Inputting an impulse function to the unknown first-order system will give us an output <script type="math/tex">Y(s)</script></p>

<script type="math/tex; mode=display">Y(s)=D(s)G(s)=1\frac{k}{1+\tau s}=\frac{k}{\tau}\frac{1}{s+\frac{1}{\tau}}</script>

<p>Again, rearranging the equation this way makes it easier to do the inverse Laplace transform back to time domain. Using the transformation listed in Laplace table, <script type="math/tex">e^{-\alpha t}f|t| \Leftrightarrow \frac{1}{s+\alpha}</script>, we get the system response
<script type="math/tex">y(t)=\frac{k}{\tau}e^{-\frac{t}{\tau}}</script></p>

<p>&lt;img src=“impOut.jpeg" alt=“Output of an impulse input to an unknown system” width="200"/&gt;</p>

<p>By plugging in two different time values, we obtain two amplitudes. The ratio of them cancels out the coefficient for the exponential.</p>

<script type="math/tex; mode=display">\frac{y(t_1)}{y(t_2)}=e^{\frac{(t_2-t_1)}{\tau}}</script>

<p>and rewrite the equation, we can calculate the time constant</p>

<script type="math/tex; mode=display">\tau=\frac{t_2-t_1}{ln(\frac{y(t_1)}{y(t_2)})}</script>

<p>After getting the time constant, we can obtain the gain from the response equation.</p>

<h1 id="heading-higher-order-system-and-bode-plot">Higher-Order System and Bode Plot</h1>
<p>For a higher-order system, the system response is more complicated. Luckily we can use a bode plot to visualize the system's transfer function. It is nothing more than a frequency spectrum. It records the amplitude and the phase of the transfer function versus frequency. However, to capture a broader range of frequency, the x-axis is in log scale. The Bode plot also uses dB for the magnitude. With a known system, the corresponding bode plot can look like the black line in the graph.</p>

<p>&lt;img src=“bodePlot.jpeg" alt=“bode plot of a transfer function magnitude” width="200"/&gt;</p>

<p>The <a href="[Bode plot - Wikipedia](https://en.wikipedia.org/wiki/Bode_plot)">corner frequencies</a> result from poles and zeros, which determine the system behavior. All of this sounds great and works well theoretically, but we don't know the system in reality.</p>

<p>Inspired by what we have been doing, we can input some signals and observe the output to gain insight into the system. For example, we don't know a system "?", but we randomly put in some numbers and get these results.</p>

<p>&lt;img src=“sysTest.jpeg" alt=“guessing a system by observing input and output” width="200"/&gt;</p>

<p>It's not hard to guess the system "?" is "+1".</p>

<p>That's precisely we want to want to do to identify our system, but what are the good signal that can be used to test out general complicated systems?</p>

<h1 id="heading-frequency-response-sine-sweep">Frequency Response (Sine Sweep)</h1>
<p>It turns out that a harmonic signal with a specific frequency is a perfect candidate. For example, if we input this kind of function into a system.</p>

<p>&lt;img src=“sinSys.jpeg" alt=“harmonic input to an unknown system” width="200"/&gt;</p>

<p>The system response can be written as a function of the unknown system <script type="math/tex">H</script>
<script type="math/tex">y(t)=|H(j\omega_0)|cos(\omega_0 t + \angle H(j\omega_0))</script></p>

<table>
  <tbody>
    <tr>
      <td>This equation shows that the output is still a cosine function with the same frequency as the input. However, the magnitude now is scaled by $$</td>
      <td>H(j\omega_0)</td>
      <td>$$ and has a phase shift \angle H(j\omega_0). Visually, this means</td>
    </tr>
  </tbody>
</table>

<p>&lt;img src=“sinOut.jpeg" alt=“Output of a harmonic input to an unknown system” width="200"/&gt;</p>

<p>Therefore, for a specific frequency, I can use the graph to obtain the system's magnitude and phase. By sweeping through multiple frequencies, I can reconstruct the bode plot. The final transfer function for the system is
<script type="math/tex">H(j\omega)=|H(j\omega_0)|e^{ \angle H(j\omega)}</script></p>


                    </div>
                </div>
            </div>
            <footer class="unit-foot">
                <div class="unit-inner unit-foot-inner">
                    <div class="post-buttons">
                        <a class="internal gotop" href="#page" title="Back to Top">Back to Top</a>
                        
                    </div>
                    <nav class="pagination">
                        
                            <a class="internal" rel="prev" href="/blog/2020/11/08/AWS-Practitioner-Certification-3/" title=" 'AWS Certified Cloud Practitioner Notes: Technology'"> ← AWS Certified Cloud Practitioner Notes: Technology</a>
                        
                        
                    </nav>
                </div>
            </footer>
            <div class="misc-content">
                
            </div>
        </div>
    </div>
</article>

                    </div>
                </div>
            </div>
        </div>
        <footer class="the-footer">
    <div class="unit-foot">
        <div class="unit-inner unit-foot-inner">
            <div class="misc vcard">
                <div class="about">
                    <h4><a href="">About</a></h4>
                    
                        <p>Machine Learning / Reinforcement Learning / Soft Robot ... without nagging</p>
                    
                    <p><small>Theme <a href="https://github.com/yizeng/jekyll-theme-simple-texture" target="_blank">Simple Texture</a> powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a>.</small></p>
                </div>
                <div class="social-links">
                    
                    <a class="ico-rss" href="/feed.xml" rel="me" target="_blank" title="feed"></a>
                    
                </div>
            </div>
        </div>
    </div>
    <a href="#" class="internal back-to-top">Back to Top</a>
</footer>

    </div>

    <script>
$(document).ready(function () {
    var offset = 50,
        duration = 500,
        width = 960;
    $(window).scroll(function () {
        if ($(window).width() > width) {
            if ($(this).scrollTop() > offset) {
                $('footer').css('top', '20px');
                $('footer .back-to-top').fadeIn(duration);
            } else {
                $('footer').css('top', 'auto');
                $('footer .back-to-top').fadeOut(duration);
            }
        }
    });
    $(window).resize(function () {
        if ($(window).width() < width) {
            $('footer').css('top', 'auto');
            $('footer .back-to-top').fadeOut(duration);
        }
        if ($(window).width() >= width && $(this).scrollTop() > offset) {
            $('footer').css('top', '20px');
            $('footer .back-to-top').fadeIn(duration);
        }
    });

    $('footer .back-to-top, .gotop').on('click', function (event) {
        event.preventDefault();
        $('html, body').animate({
            scrollTop: 0
        }, duration);
        return false;
    });

    $('.show-hidden').on('click', function () {
        $(this).parent().next().toggleClass("hidden");
        $(this).toggleClass("hidden");
    });
});
</script>

<!-- Show menu overlay + Jekyll Simple Search option -->
<script src="/assets/javascripts/jekyll-search.jquery.js"></script>
<script>
$(document).ready(function () {
    $('.search-field').simpleJekyllSearch({
      jsonFile: '/search.json',
      template: '<li><a href="{url}">{title} <span class="entry-date"><time datetime="{date}">{shortdate}</time></span></a></li>',
      searchResults: '.search-wrapper .results',
      searchResultsTitle: '<h4>Search results</h4>',
      noResults: '<p>Oh shucks<br/><small>Nothing found :(</small></p>'
    });
});

(function ($, window, undefined) {
    var closeOverlay = function () {
        $('.nav-wrapper, .search-wrapper').removeAttr('style');
        $(".nav-form, .search-form").removeClass('active');
        $("body").removeClass('nav-overlay search-overlay');
    };

    $('.nav-global .btn-search').on('click', function () {
        $('.search-wrapper').css({display: "block"});
        $(".search-form").addClass('active');
        $(".search-form").find('input').focus();
        $("body").addClass('search-overlay');
    });

    $('.nav-global .btn-menu').on('click', function () {
        $('.nav-wrapper').css({display: "block"});
        $(".nav-form").addClass('active');
        $(".nav-form .search-field").prop('disabled', true);
        $("body").addClass('nav-overlay');
    });

    $('.nav-wrapper .btn-close, .search-wrapper .btn-close').on('click', function () {
        closeOverlay();
    });

    $(document).on('keyup', function (e) {
        if (e.keyCode === 27) {
            closeOverlay();
        }
    });
})(jQuery, window);
</script>

<script src='//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.js'></script>
<script src='//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-buttons.min.js'></script>
<script src="/assets/javascripts/unveil/jquery.unveil.min.js"></script>

<script>
    window.jQuery.fancybox || document.write('<script src="/assets/javascripts/fancybox/jquery.fancybox.pack.js?v=2.1.4"><\/script>')
    window.jQuery.fancybox.helpers.buttons || document.write('<script src="/assets/javascripts/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"><\/script>')
</script>

<script>
    $("head").append('<link rel="stylesheet" href="/assets/javascripts/fancybox/jquery.fancybox.css?v=2.1.4" type="text/css" />');
    $("head").append('<link rel="stylesheet" href="/assets/javascripts/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" />');
    $(".post-image").fancybox({
        prevEffect: 'none',
        nextEffect: 'none',
        closeBtn: true,
        helpers: {
            title: {
                type: 'float'
            }
        }
    });
    $(document).ready(function () {
        $(".post-image > img").unveil(450);
    });
</script>

</body>

</html>